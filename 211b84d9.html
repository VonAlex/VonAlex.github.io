<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="preconnect" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Montserrat:ital@1&family=Noto+Sans+TC&family=Noto+Serif+SC:wght@200;300&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@500&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Montserrat:ital@1&family=Noto+Sans+TC&family=Noto+Serif+SC:wght@200;300&display=swap" rel="stylesheet"><link rel="preconnect" href="https://fonts.gstatic.com"><link rel="apple-touch-icon" sizes="76x76" href="/images/dolphin.png"><link rel="icon" type="image/png" href="/images/dolphin.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#433d3c"><meta name="description" content=""><meta name="author" content="Happen"><meta name="keywords" content=""><title>irqbalance è¯¦è§£ä¹‹ä¸€ - Happenã®Memo</title><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/rainbow.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_pf9vaxs7x7b.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/shubiao.css"><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.1.1"></head><body><header style="height:60vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/">&nbsp;<strong>Happenã®Memo</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> é¦–é¡µ</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> å½’æ¡£</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> åˆ†ç±»</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> æ ‡ç­¾</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> å…³äº</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> å‹é“¾</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" href="javascript:">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner intro-2" id="background" parallax="true" style="background:url(https://gitee.com/happencc/pics/raw/master/images/about-banner.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="container page-header text-center fade-in-up"><span class="h2" id="subtitle"></span><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Happen </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2018-06-29 10:38" pubdate>2018-06-29 10:38</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 2.5k å­— </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 33 åˆ†é’Ÿ </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> æ¬¡</span></div></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto" id="post"><h1 style="display:none">irqbalance è¯¦è§£ä¹‹ä¸€</h1><p class="note note-info">æœ¬æ–‡æœ€åæ›´æ–°äºï¼š2018-06-29 10:38</p><div class="markdown-body" id="post-body"><p>irqbalance æ˜¯ä»€ä¹ˆï¼Ÿ<a target="_blank" rel="noopener" href="https://github.com/Irqbalance/irqbalance">é¡¹ç›®ä¸»é¡µ </a>ä¸Šæœ‰ä»¥ä¸‹æè¿°ï¼š</p><blockquote><p>Irqbalance is a daemon to help balance the cpu load generated by interrupts across all of a systems cpus.</p></blockquote><!--more----><p>å®ƒé¿å…äº†å• cpu è´Ÿè½½è¿‡é‡æƒ…å†µçš„å‡ºç°ã€‚ç”¨æ³•å¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs gherkin">root<span class="hljs-meta">@a7661ef9b2f8</span> test]<span class="hljs-comment"># irqbalance -h</span>
irqbalance: option requires an argument -- &#x27;h&#x27;
irqbalance [--oneshot |<span class="hljs-string"> -o] [--debug </span>|<span class="hljs-string"> -d] [--foreground </span>|<span class="hljs-string"> -f] [--hintpolicy= </span>|<span class="hljs-string"> -h [exact</span>|<span class="hljs-string">subset</span>|<span class="hljs-string">ignore]] [--banscript= </span>|<span class="hljs-string"> -b &lt;script&gt;]</span>
<span class="hljs-string">	[--powerthresh= </span>|<span class="hljs-string"> -p &lt;off&gt; </span>|<span class="hljs-string"> &lt;n&gt;] [--banirq= </span>|<span class="hljs-string"> -i &lt;n&gt;] [--policyscript= </span>|<span class="hljs-string"> -l &lt;script&gt;] [--pid= </span>|<span class="hljs-string"> -s &lt;file&gt;] [--deepestcache= </span>|<span class="hljs-string"> -c &lt;n&gt;]</span></code></pre></div><h2><a href="#" class="headerlink"></a><div class="hljs"><pre><code class="hljs routeros"><span class="hljs-comment"># æŸ¥çœ‹å½“å‰è¿è¡Œæƒ…å†µ</span>
service irqbalance status

<span class="hljs-comment"># ç»ˆæ­¢æœåŠ¡</span>
service irqbalance stop</code></pre></div></h2><p>é¦–å…ˆæœ‰ä¸€äº›å‰ç½®çŸ¥è¯†éœ€è¦è¯´æ˜ï¼Œè¿™æ¶‰åŠåˆ° irqbalance cputree çš„åˆ†å±‚ã€‚</p><h3 id="å‰ç½®çŸ¥è¯†"><a href="# å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h3><h4 id="ä¸­æ–­"><a href="# ä¸­æ–­" class="headerlink" title="ä¸­æ–­"></a> ä¸­æ–­</h4><p>æ¯ä¸ªç¡¬ä»¶è®¾å¤‡éƒ½éœ€è¦å’Œ CPU æœ‰æŸç§å½¢å¼çš„é€šä¿¡ä»¥ä¾¿ CPU åŠæ—¶çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼Œè¿™æ · CPU å¯èƒ½å°±ä¼šæ”¾ä¸‹æ‰‹ä¸­çš„äº‹æƒ…å»å¤„ç†åº”æ€¥äº‹ä»¶ï¼Œç¡¬ä»¶è®¾å¤‡ä¸»åŠ¨æ‰“æ‰° CPU çš„ç°è±¡å°±å¯ç§°ä¸ºç¡¬ä»¶ä¸­æ–­ã€‚å°±åƒæ­£åœ¨ä¸€å¿ƒä¸€æ„çš„å†™ä»£ç æ—¶ï¼Œçªç„¶é’‰é’‰â€œå™”å™”â€åœ°å“èµ·æ¥ï¼Œè¿™æ—¶æˆ‘ä»¬å°±çŸ¥é“æœ‰äº‹æƒ…éœ€è¦å¤„ç†ï¼Œè¿™é‡Œçš„â€œå™”å™”â€å£°å°±å¯ä»¥ç†è§£æˆä¸€æ¬¡ä¸­æ–­ã€‚<br>CPU å’Œç¡¬ä»¶æ²Ÿé€šçš„æ–¹å¼ä¸­ï¼Œè¿˜æœ‰ä¸€ç§å«åšè½®è¯¢ï¼ˆpollingï¼‰ï¼Œå°±æ˜¯è®© CPU å®šæ—¶å¯¹ç¡¬ä»¶çŠ¶æ€è¿›è¡ŒæŸ¥è¯¢ç„¶ååšç›¸åº”å¤„ç†ï¼Œè¿™æ¯”è¾ƒæµªè´¹ CPUï¼Œå±äºä¸€ç§ç¡¬ä»¶è¢«åŠ¨çš„æ–¹å¼ã€‚ç›¸æ¯”ä¸‹æ¥ï¼Œç¡¬ä»¶ä¸»åŠ¨çš„æ–¹å¼ï¼ˆä¸­æ–­ï¼‰æ›´æœ‰æ•ˆä¸€äº›ã€‚<br>é‚£æ¯ä¸ªç¡¬ä»¶è®¾å¤‡éƒ½æœ‰ä¸­æ–­ï¼Œå¾ˆç®€å•å•Šï¼Œç»™å®ƒä»¬åˆ†ä¸ªå”¯ä¸€çš„å·ç ï¼Œä¹Ÿå°±æ˜¯ irq å·ï¼Œåœ¨ <code>/proc/interrupts</code> æ–‡ä»¶ä¸­çš„ç¬¬ä¸€åˆ—å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„ irqã€‚<br>åªæœ‰ kernel 2.4 ä»¥åçš„ç‰ˆæœ¬æ‰æ”¯æŒçš„æŠŠä¸åŒçš„ç¡¬ä»¶ä¸­æ–­è¯·æ±‚ï¼ˆIRQsï¼‰åˆ†é…åˆ°ç‰¹å®šçš„ CPU ä¸Šçš„ç»‘å®šæŠ€æœ¯è¢«ç§°ä¸º SMP IRQ Affinityï¼Œè¿™ä¸ªåé¢è¿˜ä¼šè¯¦ç»†è¯´ã€‚</p><h4 id="NUMA æ¶æ„"><a href="#NUMA æ¶æ„" class="headerlink" title="NUMA æ¶æ„"></a>NUMA æ¶æ„</h4><p>ç®€è¦ä»‹ç»ä¸€ä¸‹ NUMA æ¶æ„ã€‚<br>NUMA æ¶æ„å‡ºç°å‰ï¼ŒCPU é¢‘ç‡ä¸€è·¯æ¬¢è„±è¶Šæ¥è¶Šé«˜ï¼Œç›´è‡³ç¢°åˆ°ç‰©ç†æé™çš„å¤©èŠ±æ¿ï¼Œåè½¬å‘æ ¸æ•°è¶Šæ¥è¶Šå¤šçš„æ–¹å‘å‘å±•ã€‚</p><blockquote><p>å¦‚æœæ¯ä¸ª core çš„å·¥ä½œæ€§è´¨éƒ½æ˜¯ share-nothingï¼ˆç±»ä¼¼äº map-reduce çš„ node èŠ‚ç‚¹çš„ä½œä¸šå±æ€§ï¼‰ï¼Œé‚£ä¹ˆä¹Ÿè®¸å°±ä¸ä¼šæœ‰ NUMAã€‚ç”±äºæ‰€æœ‰ CPU Core éƒ½æ˜¯é€šè¿‡å…±äº«ä¸€ä¸ªåŒ—æ¡¥æ¥è¯»å–å†…å­˜ï¼Œéšç€æ ¸æ•°å¦‚ä½•çš„å‘å±•ï¼Œ<strong>åŒ—æ¡¥</strong> åœ¨å“åº”æ—¶é—´ä¸Šçš„æ€§èƒ½ç“¶é¢ˆè¶Šæ¥è¶Šæ˜æ˜¾ã€‚äºæ˜¯ï¼Œèªæ˜çš„ç¡¬ä»¶è®¾è®¡å¸ˆä»¬ï¼Œå…ˆåˆ°äº†æŠŠå†…å­˜æ§åˆ¶å™¨ï¼ˆåŸæœ¬åŒ—æ¡¥ä¸­è¯»å–å†…å­˜çš„éƒ¨åˆ†ï¼‰ä¹Ÿåšä¸ªæ‹†åˆ†ï¼Œå¹³åˆ†åˆ°äº†æ¯ä¸ª die ä¸Šã€‚äºæ˜¯ NUMA å°±å‡ºç°äº†ï¼<br>NUMA æ¶æ„ä¸­ï¼Œå†…å­˜è®¿é—®æœ‰è¿œè¿‘ä¹‹åˆ†ï¼Œåªæœ‰å½“ CPU è®¿é—®è‡ªèº«ç›´æ¥ attach å†…å­˜å¯¹åº”çš„ç‰©ç†åœ°å€æ—¶ï¼Œæ‰ä¼šæœ‰è¾ƒçŸ­çš„å“åº”æ—¶é—´ï¼ˆLocal Accessï¼‰ã€‚è€Œå¦‚æœéœ€è¦è®¿é—®å…¶ä»– CPU attach çš„å†…å­˜çš„æ•°æ®æ—¶ï¼Œå°±éœ€è¦é€šè¿‡ inter-connect é€šé“è®¿é—®ï¼Œå“åº”æ—¶é—´å°±ç›¸æ¯”ä¹‹å‰å˜æ…¢äº†ï¼ˆRemote Accessï¼‰ï¼ŒNUMAï¼ˆNon-Uniform Memory Accessï¼‰å°±æ­¤å¾—åã€‚ â€”- å¼•è‡ª <a target="_blank" rel="noopener" href="http://cenalulu.github.io/linux/numa/">http://cenalulu.github.io/linux/numa/</a></p></blockquote><p>å›¾ç”»ä¸‹æ¥å¤§æ¦‚æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š<br><img src="https://s1.ax1x.com/2018/10/28/icwcV0.jpg" srcset="/img/loading.gif" width="600"></p><p><code>numactl --hardware</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹çš„é‚£ä¸ªæœºå™¨çš„ numa æ‹“æ‰‘ï¼Œæ¯”å¦‚è¿™å°æœºå™¨ï¼š</p><div class="hljs"><pre><code class="hljs angelscript">[<span class="hljs-symbol">root@</span>d2b9eb755bb1 ~]# numactl --hardware
available: <span class="hljs-number">2</span> nodes (<span class="hljs-number">0</span><span class="hljs-number">-1</span>)
node <span class="hljs-number">0</span> cpus: <span class="hljs-number">0</span> <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> <span class="hljs-number">5</span> <span class="hljs-number">6</span> <span class="hljs-number">7</span> <span class="hljs-number">8</span> <span class="hljs-number">9</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span> <span class="hljs-number">24</span> <span class="hljs-number">25</span> <span class="hljs-number">26</span> <span class="hljs-number">27</span> <span class="hljs-number">28</span> <span class="hljs-number">29</span> <span class="hljs-number">30</span> <span class="hljs-number">31</span> <span class="hljs-number">32</span> <span class="hljs-number">33</span> <span class="hljs-number">34</span> <span class="hljs-number">35</span>
node <span class="hljs-number">0</span> size: <span class="hljs-number">130946</span> MB
node <span class="hljs-number">0</span> free: <span class="hljs-number">9892</span> MB
node <span class="hljs-number">1</span> cpus: <span class="hljs-number">12</span> <span class="hljs-number">13</span> <span class="hljs-number">14</span> <span class="hljs-number">15</span> <span class="hljs-number">16</span> <span class="hljs-number">17</span> <span class="hljs-number">18</span> <span class="hljs-number">19</span> <span class="hljs-number">20</span> <span class="hljs-number">21</span> <span class="hljs-number">22</span> <span class="hljs-number">23</span> <span class="hljs-number">36</span> <span class="hljs-number">37</span> <span class="hljs-number">38</span> <span class="hljs-number">39</span> <span class="hljs-number">40</span> <span class="hljs-number">41</span> <span class="hljs-number">42</span> <span class="hljs-number">43</span> <span class="hljs-number">44</span> <span class="hljs-number">45</span> <span class="hljs-number">46</span> <span class="hljs-number">47</span>
node <span class="hljs-number">1</span> size: <span class="hljs-number">131072</span> MB
node <span class="hljs-number">1</span> free: <span class="hljs-number">35969</span> MB
node distances:
node   <span class="hljs-number">0</span>   <span class="hljs-number">1</span>
  <span class="hljs-number">0</span>:  <span class="hljs-number">10</span>  <span class="hljs-number">21</span>
  <span class="hljs-number">1</span>:  <span class="hljs-number">21</span>  <span class="hljs-number">10</span></code></pre></div><p>æˆ–è€…ç”¨è¿™ä¸ªè„šæœ¬ä¹Ÿè¡Œ:</p><div class="hljs"><pre><code class="hljs gradle">[root@d2b9eb755bb1 ~]# <span class="hljs-keyword">for</span> i in `ls <span class="hljs-regexp">/sys/</span>devices<span class="hljs-regexp">/system/</span>node | <span class="hljs-keyword">grep</span> node`;<span class="hljs-keyword">do</span> echo -ne <span class="hljs-string">&quot;$i\t&quot;</span>;cat <span class="hljs-regexp">/sys/</span>devices<span class="hljs-regexp">/system/</span>node<span class="hljs-regexp">/$i/</span>cpulist;done
node0	<span class="hljs-number">0</span>-<span class="hljs-number">11</span>,<span class="hljs-number">24</span>-<span class="hljs-number">35</span>
node1	<span class="hljs-number">12</span>-<span class="hljs-number">23</span>,<span class="hljs-number">36</span>-<span class="hljs-number">47</span></code></pre></div><p>æˆ–è€…ç”¨ <code>lscpu</code> è¿™ä¸ªå‘½ä»¤ï¼Œ</p><div class="hljs"><pre><code class="hljs yaml">[<span class="hljs-string">root@d2b9eb755bb1</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># lscpu</span>
<span class="hljs-attr">Architecture:</span>          <span class="hljs-string">x86_64</span>
<span class="hljs-string">CPU</span> <span class="hljs-string">op-mode(s):</span>        <span class="hljs-number">32</span><span class="hljs-string">-bit,</span> <span class="hljs-number">64</span><span class="hljs-string">-bit</span>
<span class="hljs-attr">Byte Order:</span>            <span class="hljs-string">Little</span> <span class="hljs-string">Endian</span>
<span class="hljs-string">CPU(s):</span>                <span class="hljs-number">48</span>
<span class="hljs-string">On-line</span> <span class="hljs-string">CPU(s)</span> <span class="hljs-attr">list:</span>   <span class="hljs-number">0</span><span class="hljs-number">-47</span>
<span class="hljs-string">Thread(s)</span> <span class="hljs-attr">per core:</span>    <span class="hljs-number">2</span>
<span class="hljs-string">Core(s)</span> <span class="hljs-attr">per socket:</span>    <span class="hljs-number">12</span>
<span class="hljs-string">Socket(s):</span>             <span class="hljs-number">2</span>
<span class="hljs-string">NUMA</span> <span class="hljs-string">node(s):</span>          <span class="hljs-number">2</span>
<span class="hljs-attr">Vendor ID:</span>             <span class="hljs-string">GenuineIntel</span>
<span class="hljs-attr">CPU family:</span>            <span class="hljs-number">6</span>
<span class="hljs-attr">Model:</span>                 <span class="hljs-number">79</span>
<span class="hljs-attr">Stepping:</span>              <span class="hljs-number">1</span>
<span class="hljs-attr">CPU MHz:</span>               <span class="hljs-number">2197.264</span>
<span class="hljs-attr">BogoMIPS:</span>              <span class="hljs-number">4401.60</span>
<span class="hljs-attr">Virtualization:</span>        <span class="hljs-string">VT-x</span>
<span class="hljs-attr">L1d cache:</span>             <span class="hljs-string">32K</span>
<span class="hljs-attr">L1i cache:</span>             <span class="hljs-string">32K</span>
<span class="hljs-attr">L2 cache:</span>              <span class="hljs-string">256K</span>
<span class="hljs-attr">L3 cache:</span>              <span class="hljs-string">30720K</span>
<span class="hljs-string">NUMA</span> <span class="hljs-string">node0</span> <span class="hljs-string">CPU(s):</span>     <span class="hljs-number">0</span><span class="hljs-number">-11</span><span class="hljs-string">,24-35</span>
<span class="hljs-string">NUMA</span> <span class="hljs-string">node1</span> <span class="hljs-string">CPU(s):</span>     <span class="hljs-number">12</span><span class="hljs-number">-23</span><span class="hljs-string">,36-47</span></code></pre></div><h4 id="CPU- ç›¸å…³"><a href="#CPU- ç›¸å…³" class="headerlink" title="CPU ç›¸å…³"></a>CPU ç›¸å…³</h4><p>cpu cache ç»“æ„å›¾å¦‚ä¸‹ï¼š<br><img src="https://s1.ax1x.com/2018/10/28/icww8g.jpg" srcset="/img/loading.gif" width="650"><br>ä»ç¡¬ä»¶çš„è§’åº¦ï¼Œä¸Šå›¾çš„ L1 å’Œ L2 Cache éƒ½è¢«ä¸¤ä¸ª HT å…±äº«ï¼Œä¸”åœ¨åŒä¸€ä¸ªç‰©ç† Coreã€‚è€Œ L3 Cache åˆ™åœ¨ç‰©ç† CPU é‡Œï¼Œè¢«å¤šä¸ª Core æ¥å…±äº«ã€‚ è€Œä» OS å†…æ ¸è§’åº¦ï¼Œæ¯ä¸ª HT éƒ½æ˜¯ä¸€ä¸ªé€»è¾‘ CPUã€‚<br>ä»¥ <strong>cpu0</strong> ä¸ºä¾‹ï¼Œå¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs gradle">[root@d2b9eb755bb1 ~]# tree -L <span class="hljs-number">1</span> <span class="hljs-regexp">/sys/</span>devices<span class="hljs-regexp">/system/</span>cpu<span class="hljs-regexp">/cpu0/</span>cache/
<span class="hljs-regexp">/sys/</span>devices<span class="hljs-regexp">/system/</span>cpu<span class="hljs-regexp">/cpu0/</span>cache/
â”œâ”€â”€ index0   -&gt; L1 data ç¼“å­˜
â”œâ”€â”€ index1   -&gt; L1 Instruction ç¼“å­˜
â”œâ”€â”€ index2   -&gt; L2 ç¼“å­˜
â””â”€â”€ index3   -&gt; L3 ç¼“å­˜</code></pre></div><p>ç‚¹åˆ°ä¸ºæ­¢ï¼Œæƒ³äº†è§£æ›´å¤šå¯ä»¥ç¿»ç¿»ä»¥å‰çš„è¯¾æœ¬ã€‚æ›´å¤š cpu ä¿¡æ¯å¯ä»¥ä» <code>/proc/cpuinfo</code> æ–‡ä»¶ä¸­è·å–åˆ°ã€‚</p><h4 id="irq- äº²ç¼˜ç»‘å®š"><a href="#irq- äº²ç¼˜ç»‘å®š" class="headerlink" title="irq äº²ç¼˜ç»‘å®š"></a>irq äº²ç¼˜ç»‘å®š</h4><p>ä¸‹é¢åŸºäºå®è·µç®€å•è¯´ä¸‹è¿™ä¸ªäº‹æƒ…ã€‚<br><code>/proc/interrupts</code> æ–‡ä»¶ä¸­å¯ä»¥çœ‹åˆ°å„ä¸ª cpu ä¸Šçš„ä¸­æ–­æƒ…å†µã€‚<br><code>/proc/irq/#/smp_affinity_list</code> å¯ä»¥æŸ¥çœ‹æŒ‡å®šä¸­æ–­å½“å‰ç»‘å®šçš„ CPUï¼Œå½“ç„¶ä¹Ÿ å¯ä»¥çœ‹ <code>smp_affinity</code> è¿™ä¸ªæ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ä¸ª 16 è¿›åˆ¶ bitmaskï¼Œä»¥é€—å·åˆ†éš”ï¼Œæ¯”å¦‚ <code>0000,00000020</code>è¡¨ç¤ºè¯¥ irq åˆ†ç»™äº† CPU5ã€‚</p><p>æ‰€ä»¥ï¼Œé€šè¿‡å¦‚ä¸‹è„šæœ¬è·å¾— <strong>å„ç½‘å¡ä¸­æ–­ </strong>çš„å½“å‰ cpu çš„æ•´ä½“æƒ…å†µï¼ˆå¹³æ—¶åªå¯¹ç½‘å¡ä¸­æ–­æ„Ÿå…´è¶£ï¼‰ï¼š</p><div class="hljs"><pre><code class="hljs gradle">cat <span class="hljs-regexp">/proc/i</span>nterrupts | <span class="hljs-keyword">grep</span> eth0- | cut -d: -f1 | <span class="hljs-keyword">while</span> <span class="hljs-keyword">read</span> i; <span class="hljs-keyword">do</span> echo -ne irq<span class="hljs-string">&quot;:$i\t bind_cpu: &quot;</span>; cat <span class="hljs-regexp">/proc/i</span>rq<span class="hljs-regexp">/$i/</span>smp_affinity_list; done | <span class="hljs-keyword">sort</span> -n -t<span class="hljs-string">&#x27; &#x27;</span> -k3</code></pre></div><p>æ•ˆæœå¤§çº¦æ˜¯è¿™æ ·çš„ï¼š</p><div class="hljs"><pre><code class="hljs angelscript">irq:<span class="hljs-number">113</span>	 bind_cpu: <span class="hljs-number">0</span>
irq:<span class="hljs-number">117</span>	 bind_cpu: <span class="hljs-number">1</span>
irq:<span class="hljs-number">136</span>	 bind_cpu: <span class="hljs-number">2</span>
irq:<span class="hljs-number">109</span>	 bind_cpu: <span class="hljs-number">3</span>
irq:<span class="hljs-number">137</span>	 bind_cpu: <span class="hljs-number">4</span>
irq:<span class="hljs-number">106</span>	 bind_cpu: <span class="hljs-number">5</span>
irq:<span class="hljs-number">112</span>	 bind_cpu: <span class="hljs-number">6</span>
irq:<span class="hljs-number">111</span>	 bind_cpu: <span class="hljs-number">7</span>
irq:<span class="hljs-number">115</span>	 bind_cpu: <span class="hljs-number">8</span>
irq:<span class="hljs-number">149</span>	 bind_cpu: <span class="hljs-number">8</span>
irq:<span class="hljs-number">152</span>	 bind_cpu: <span class="hljs-number">8</span>
irq:<span class="hljs-number">133</span>	 bind_cpu: <span class="hljs-number">9</span>
irq:<span class="hljs-number">110</span>	 bind_cpu: <span class="hljs-number">10</span>
irq:<span class="hljs-number">114</span>	 bind_cpu: <span class="hljs-number">11</span>
irq:<span class="hljs-number">130</span>	 bind_cpu: <span class="hljs-number">24</span>
irq:<span class="hljs-number">148</span>	 bind_cpu: <span class="hljs-number">24</span>
irq:<span class="hljs-number">131</span>	 bind_cpu: <span class="hljs-number">25</span>
irq:<span class="hljs-number">139</span>	 bind_cpu: <span class="hljs-number">26</span>
irq:<span class="hljs-number">118</span>	 bind_cpu: <span class="hljs-number">27</span>
irq:<span class="hljs-number">132</span>	 bind_cpu: <span class="hljs-number">27</span>
irq:<span class="hljs-number">123</span>	 bind_cpu: <span class="hljs-number">28</span>
irq:<span class="hljs-number">128</span>	 bind_cpu: <span class="hljs-number">28</span>
irq:<span class="hljs-number">134</span>	 bind_cpu: <span class="hljs-number">28</span>
irq:<span class="hljs-number">142</span>	 bind_cpu: <span class="hljs-number">28</span>
irq:<span class="hljs-number">150</span>	 bind_cpu: <span class="hljs-number">28</span>
irq:<span class="hljs-number">135</span>	 bind_cpu: <span class="hljs-number">29</span>
irq:<span class="hljs-number">108</span>	 bind_cpu: <span class="hljs-number">30</span>
irq:<span class="hljs-number">116</span>	 bind_cpu: <span class="hljs-number">31</span>
irq:<span class="hljs-number">119</span>	 bind_cpu: <span class="hljs-number">32</span>
irq:<span class="hljs-number">124</span>	 bind_cpu: <span class="hljs-number">32</span>
irq:<span class="hljs-number">126</span>	 bind_cpu: <span class="hljs-number">32</span>
irq:<span class="hljs-number">127</span>	 bind_cpu: <span class="hljs-number">32</span>
irq:<span class="hljs-number">138</span>	 bind_cpu: <span class="hljs-number">32</span>
irq:<span class="hljs-number">151</span>	 bind_cpu: <span class="hljs-number">32</span>
irq:<span class="hljs-number">107</span>	 bind_cpu: <span class="hljs-number">33</span>
irq:<span class="hljs-number">121</span>	 bind_cpu: <span class="hljs-number">34</span>
irq:<span class="hljs-number">140</span>	 bind_cpu: <span class="hljs-number">34</span>
irq:<span class="hljs-number">120</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">122</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">125</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">129</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">141</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">143</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">144</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">145</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">146</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">147</span>	 bind_cpu: <span class="hljs-number">35</span>
irq:<span class="hljs-number">153</span>	 bind_cpu: <span class="hljs-number">35</span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘è¿™å°æœºå™¨æœ‰ä¸€åŠ cpu æ˜¯ç©ºé—²çš„ï¼Œå·²ç»ç»‘å®šçš„ cpu ç»‘å®šçš„ irq ä¹Ÿä¸å¤ªå‡è¡¡ã€‚<br>å‡å¦‚è¦æ›´æ”¹çš„è¯ï¼Œå¯ä»¥æœ‰å¦‚ä¸‹ç±»ä¼¼çš„æ“ä½œ <code>echo 3 &gt; /proc/irq/24/smp_affinity</code>ã€‚<br>è¿™ä¸ªä¹Ÿæ˜¯åé¢ irqbalance ç”¨æ¥è°ƒæ•´ä¸­æ–­çš„æ–¹æ³•ã€‚</p><h3 id="irqbalance- ä»£ç åˆ†æ"><a href="#irqbalance- ä»£ç åˆ†æ" class="headerlink" title="irqbalance ä»£ç åˆ†æ"></a>irqbalance ä»£ç åˆ†æ</h3><p>ä¸‹é¢ä»¥ v1.07 ä¸ºä¾‹æ¥è¿›è¡Œåˆ†æã€‚</p><p>irqbalance ä¸­æŠŠä¸­æ–­åˆ†æˆäº† 8 ç§ class, 4 ç§ typeã€‚</p><div class="hljs"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span>
<span class="hljs-comment"> * IRQ Classes</span>
<span class="hljs-comment"> */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_OTHER       0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_LEGACY      1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_SCSI        2</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_VIDEO       3</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_ETH         4</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_GBETH       5</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_10GBETH     6</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_VIRT_EVENT  7</span>

<span class="hljs-comment">/*</span>
<span class="hljs-comment"> * IRQ Types</span>
<span class="hljs-comment"> */</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_TYPE_LEGACY     0</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_TYPE_MSI        1</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_TYPE_MSIX       2</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> IRQ_TYPE_VIRT_EVENT 3</span></code></pre></div><p>ä¸ºå•¥æ˜¯ 8 ç§ class å‘¢ï¼Ÿè¿™ä¸ªæ˜¯ä¾æ® pci è®¾å¤‡åˆå§‹åŒ–æ—¶æ³¨å†Œçš„ç±»å‹ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹è„šæœ¬æ¥æŸ¥çœ‹</p><div class="hljs"><pre><code class="hljs mel">[root@d2b9eb755bb1 ~]# <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">`ls /sys/bus/pci/devices/*/class`</span>;<span class="hljs-keyword">do</span> echo $((<span class="hljs-string">`cat $i`</span> &gt;&gt; <span class="hljs-number">16</span>));done  | <span class="hljs-keyword">sort</span> -nu | wc -l
<span class="hljs-number">8</span></code></pre></div><p>ä»¥ä¸Šçš„ class å¯¹åº” IRQ Classes ä½¿ç”¨å¦‚ä¸‹çš„æ•°ç»„ï¼š</p><div class="hljs"><pre><code class="hljs autohotkey">static short class_codes[MAX_CLASS] = &#123;
<span class="hljs-built_in">	IRQ_OTHER,</span>
<span class="hljs-built_in">	IRQ_SCSI,</span>
<span class="hljs-built_in">	IRQ_ETH,</span>
<span class="hljs-built_in">	IRQ_VIDEO,</span>
<span class="hljs-built_in">	IRQ_OTHER,</span>
<span class="hljs-built_in">	IRQ_OTHER,</span>
<span class="hljs-built_in">	IRQ_LEGACY,</span>
<span class="hljs-built_in">	IRQ_OTHER,</span>
<span class="hljs-built_in">	IRQ_OTHER,</span>
<span class="hljs-built_in">	IRQ_LEGACY,</span>
<span class="hljs-built_in">	IRQ_OTHER,</span>
<span class="hljs-built_in">	IRQ_OTHER,</span>
<span class="hljs-built_in">	IRQ_LEGACY,</span>
<span class="hljs-built_in">	IRQ_ETH,</span>
<span class="hljs-built_in">	IRQ_SCSI,</span>
<span class="hljs-built_in">	IRQ_OTHER,</span>
<span class="hljs-built_in">	IRQ_OTHER,</span>
<span class="hljs-built_in">	IRQ_OTHER,</span>
&#125;<span class="hljs-comment">;</span></code></pre></div><p><code>MAX_CLASS = 0x12</code> å³ 18ã€‚<br>ä¸åŒ class çš„ä¸­æ–­å¹³è¡¡çš„æ—¶å€™ä½œç”¨åŸŸä¸åŒï¼Œæœ‰çš„åœ¨ PACKAGEï¼Œæœ‰çš„åœ¨ CACHEï¼Œæœ‰çš„åœ¨ COREã€‚è¿™ä¸ªå…³ç³»å¯¹åº”ä¾é ä»¥ä¸‹æ•°ç»„è¿›è¡Œè½¬æ¢:</p><div class="hljs"><pre><code class="hljs mipsasm">int map_class_to_level[<span class="hljs-number">8</span>] =
&#123; <span class="hljs-keyword">BALANCE_PACKAGE, </span><span class="hljs-keyword">BALANCE_CACHE, </span><span class="hljs-keyword">BALANCE_CORE, </span><span class="hljs-keyword">BALANCE_CORE, </span><span class="hljs-keyword">BALANCE_CORE, </span><span class="hljs-keyword">BALANCE_CORE, </span><span class="hljs-keyword">BALANCE_CORE, </span><span class="hljs-keyword">BALANCE_CORE </span>&#125;;</code></pre></div><p>irqbalance ä¼šæ ¹æ® cpu çš„ç»“æ„ç”±ä¸Šåˆ°ä¸‹å»ºç«‹äº†ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œæœ€é¡¶å±‚æ˜¯ numa_nodesï¼Œå‘ä¸‹ä»¥æ­¤ä¸º CPU packagesã€Cache domains ä»¥åŠ CPU coresï¼Œè‡ªé¡¶å‘ä¸‹ã€‚</p><p>irqbalance çš„ä¸»å‡½æ•°å¾ˆç®€å•ï¼Œ10s ä¸€ä¸ªå‘¨æœŸï¼Œåšä»¥ä¸‹äº‹æƒ…ï¼š<br>ã€1ã€‘æ¸…é™¤ä¸Šæ¬¡ç»Ÿè®¡ç»“æœ<br>ã€2ã€‘åˆ†æä¸­æ–­æƒ…å†µ<br>ã€3ã€‘åˆ†æä¸­æ–­çš„è´Ÿè½½æƒ…å†µ<br>ã€4ã€‘è®¡ç®—å¦‚ä½•å¹³è¡¡ä¸­æ–­<br>ã€5ã€‘å®æ–½ä¸Šé¢æŒ‡å®šçš„æ–¹æ¡ˆ</p><div class="hljs"><pre><code class="hljs reasonml"><span class="hljs-comment">// irqbalance.c</span>
<span class="hljs-built_in">int</span> main(<span class="hljs-built_in">int</span> argc, <span class="hljs-built_in">char</span>** argv) &#123;
    <span class="hljs-comment">// ...</span>
    <span class="hljs-comment">// ...</span>
    <span class="hljs-keyword">while</span> (keep_going) &#123;
        sleep<span class="hljs-constructor">_approx(SLEEP_INTERVAL)</span>; <span class="hljs-comment">// 10s</span>
        clear<span class="hljs-constructor">_work_stats()</span>;
truetrue parse<span class="hljs-constructor">_proc_interrupts()</span>;
truetrue parse<span class="hljs-constructor">_proc_stat()</span>;
truetrue <span class="hljs-comment">// ...</span>
truetrue <span class="hljs-comment">// ...</span>
truetruecalculate<span class="hljs-constructor">_placement()</span>;
truetrueactivate<span class="hljs-constructor">_mappings()</span>;
truetrue<span class="hljs-comment">// ...</span>
    &#125;
    <span class="hljs-comment">// ...</span>
&#125;</code></pre></div><p>ä¸­æ–­æœ€ç»ˆæ˜¯è¿è¡Œåœ¨æŸä¸€ä¸ª cpu ä¸Šçš„ï¼Œæ‰€ä»¥æœ‰çš„ä¸­æ–­è™½ç„¶åˆ†é…åœ¨ cacheã€package å±‚æ¬¡ä¸Šï¼Œä½†æ˜¯æœ€ç»ˆè¿˜æ˜¯åœ¨ cpu ä¸Šè¿è¡Œï¼Œæ‰€æœ‰æ¯ä¸ª cpu æ‰§è¡Œä¸­æ–­æ•°å¤§æ¦‚ç­‰äºæ‰€æœ‰çˆ¶èŠ‚ç‚¹çš„ä¸­æ–­æ•°ä¸€çº§ä¸€çº§å¹³å‡ä¸‹æ¥ã€‚ç„¶åç”¨è¯¥ cpu çš„è´Ÿè½½é™¤ä»¥è¯¥ cpu å¹³å‡å¤„ç†çš„ä¸­æ–­æ•°ï¼Œå¾—åˆ°å•ä½ä¸­æ–­æ‰€å ç”¨çš„è´Ÿè½½ï¼Œé‚£ä¹ˆæ¯ä¸ªä¸­æ–­çš„è´Ÿè½½å°±ç­‰äºè¯¥ä¸­æ–­åœ¨å•ä½æ—¶é—´å†…æ–°å¢çš„ä¸ªæ•°ä¹˜ä»¥å•ä½ä¸­æ–­æ‰€å ç”¨çš„è´Ÿè½½ã€‚é‚£é—®é¢˜æ¥äº†ï¼Œå¦‚ä½•è®¡ç®—è´Ÿè½½çš„å‘¢ï¼Ÿ<br>ç­”æ¡ˆæ˜¯é€šè¿‡<code>/proc/stat</code> æ–‡ä»¶çš„ <strong>irq + softirq</strong> è·å¾—çš„ï¼Œä»¥ cpu0 ä¸ºä¾‹ï¼Œä¸€ä¸ªå¯èƒ½çš„æ•°æ®å¦‚ä¸‹ï¼š</p><div class="hljs"><pre><code class="hljs angelscript">cpu0 <span class="hljs-number">200118431</span> <span class="hljs-number">1258</span> <span class="hljs-number">112897097</span> <span class="hljs-number">1062445972</span> <span class="hljs-number">321829</span> <span class="hljs-number">0</span> <span class="hljs-number">1048436</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span> <span class="hljs-number">0</span></code></pre></div><p>ä»¥ä¸Šçš„æ•°ç»„è¡¨ç¤ºä»ç³»ç»Ÿå¯åŠ¨å¼€å§‹ç´¯è®¡åˆ°å½“å‰æ—¶åˆ»çš„ <strong>jiffies</strong>æ•° (jiffies æ˜¯å†…æ ¸ä¸­çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨æ¥è®°å½•è‡ªç³»ç»Ÿå¯åŠ¨ä¸€æ¥äº§ç”Ÿçš„èŠ‚æ‹æ•°ï¼Œåœ¨ linux ä¸­ï¼Œä¸€ä¸ªèŠ‚æ‹å¤§è‡´å¯ç†è§£ä¸ºæ“ä½œç³»ç»Ÿè¿›ç¨‹è°ƒåº¦çš„æœ€å°æ—¶é—´ç‰‡ï¼Œä¸åŒ linux å†…æ ¸å¯èƒ½å€¼æœ‰ä¸åŒï¼Œé€šå¸¸åœ¨ 1ms åˆ° 10ms ä¹‹é—´)ã€‚<br>ä»¥ä¸Šå„å­—æ®µçš„å«ä¹‰å¦‚ä¸‹è¡¨ï¼š</p><div class="table-container"><table><thead><tr><th style="text-align:left">æ•°å€¼</th><th style="text-align:left">å‚æ•°</th><th style="text-align:right">å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left">200118431</td><td style="text-align:left">user</td><td style="text-align:right">å¤„äºç”¨æˆ·æ€çš„è¿è¡Œæ—¶é—´ï¼Œä¸åŒ…å« nice å€¼ä¸ºè´Ÿè¿›ç¨‹ã€‚</td></tr><tr><td style="text-align:left">1258</td><td style="text-align:left">nice</td><td style="text-align:right">nice å€¼ä¸ºè´Ÿçš„è¿›ç¨‹æ‰€å ç”¨çš„ CPU æ—¶é—´</td></tr><tr><td style="text-align:left">112897097</td><td style="text-align:left">system</td><td style="text-align:right">å¤„äºæ ¸å¿ƒæ€çš„è¿è¡Œæ—¶é—´</td></tr><tr><td style="text-align:left">1062445972</td><td style="text-align:left">idle</td><td style="text-align:right">é™¤ IO ç­‰å¾…æ—¶é—´ä»¥å¤–çš„å…¶å®ƒç­‰å¾…æ—¶é—´</td></tr><tr><td style="text-align:left">321829</td><td style="text-align:left">iowait</td><td style="text-align:right">IO ç­‰å¾…æ—¶é—´(since 2.5.41)</td></tr><tr><td style="text-align:left">0</td><td style="text-align:left">irq</td><td style="text-align:right">ç¡¬ä¸­æ–­æ—¶é—´</td></tr><tr><td style="text-align:left">1048436</td><td style="text-align:left">softirq</td><td style="text-align:right">è½¯ä¸­æ–­æ—¶é—´</td></tr><tr><td style="text-align:left">0</td><td style="text-align:left">steal</td><td style="text-align:right">-</td></tr><tr><td style="text-align:left">0</td><td style="text-align:left">guest</td><td style="text-align:right">-</td></tr><tr><td style="text-align:left">0</td><td style="text-align:left">guest_nice</td><td style="text-align:right">-</td></tr></tbody></table></div><p>å…·ä½“å¯ä»¥çœ‹ <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man5/proc.5.html">/proc ç›®å½•è¯¦è§£ </a>ã€‚<br>æ‰€ä»¥ï¼Œ<code>cpu-&gt;last_load = (irq_load + softirq_load)</code>ã€‚<br>æ¯ä¸ª CORE çš„è´Ÿè½½æ˜¯é™„åœ¨ä¸Šé¢çš„ä¸­æ–­çš„è´Ÿè½½çš„æ€»å’Œï¼Œ<br>æ¯ä¸ª DOMAIN æ˜¯åŒ…å«çš„ CORE çš„æ€»å’Œï¼Œ<br>æ¯ä¸ª PACKAGE åŒ…å«çš„ DOMAIN çš„æ€»å’Œï¼Œå°±åƒæ ‘å±‚æ¬¡ä¸€æ ·çš„è®¡ç®—ã€‚</p><p>å…³äºå¦‚ä½•å¹³è¡¡ä¸Šé¢å¾—åˆ°çš„ load å€¼å‘¢ï¼Ÿä¸‹ä¸€ç¯‡å†åšè®²è§£ã€‚</p><p><strong>To be continuedâ€¦</strong></p></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/linux/">linux</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/shell/">shell</a></div></div><p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p><div class="post-prevnext row"><article class="post-prev col-6"><a href="/fe52c850.html"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">dstat å·¥å…·ä½¿ç”¨</span> <span class="visible-mobile">ä¸Šä¸€ç¯‡</span></a></article><article class="post-next col-6"><a href="/1f742d6d.html"><span class="hidden-mobile">ä» tcpdump æŠ“åŒ…çœ‹ TCP/IP åè®®</span> <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC8zNjg1MS8xMzM4Nw"><script type="text/javascript">function loadLivere(){addScript("https://cdn-city.livere.com/js/embed.dist.js")}waitElementVisible("lv-container",loadLivere)</script><noscript>ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·å…è®¸ JavaScript è¿è¡Œ</noscript></div></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p><div id="tocbot"></div></div></div></div></div></main><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><footer class="mt-5"><div class="text-center py-3"><div><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="footer-content"><div><span id="timeDate">è½½å…¥å¤©æ•°...</span> <span id="times">è½½å…¥æ—¶åˆ†ç§’...</span><script>var now=new Date;function createtime(){var n=new Date("04/03/2016 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="ğŸš€ &nbsp"+dnum+"&nbspå¤©",document.getElementById("times").innerHTML=hnum+"&nbspå°æ—¶&nbsp"+mnum+"&nbspåˆ†&nbsp"+snum+"&nbspç§’"}setInterval("createtime()",250)</script></div></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv"></span> æ¬¡ </span><span id="busuanzi_container_site_uv" style="display:none">æ€»è®¿å®¢æ•° <span id="busuanzi_value_site_uv"></span> äºº</span></div></div></footer><script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script><script src="/js/debouncer.js"></script><script src="/js/main.js"></script><script src="/js/lazyload.js"></script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script src="/js/clipboard-use.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js"></script><script>$(document).ready(function(){var t=$("#board-ctn").offset().top;tocbot.init({tocSelector:"#tocbot",contentSelector:"#post-body",headingSelector:"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:3,scrollSmooth:!0,headingsOffset:-t}),0<$(".toc-list-item").length&&$("#toc").css("visibility","visible")})</script><script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script><script>var typed=new Typed("#subtitle",{strings:["  ","irqbalance è¯¦è§£ä¹‹ä¸€&nbsp;"],cursorChar:"|",typeSpeed:72,loop:!1});typed.stop(),$(document).ready(function(){$(".typed-cursor").addClass("h2"),typed.start()})</script><script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script><script>anchors.options = {
      placement: "right",
      visible: "hover",
      
      icon: "Â§"
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))</script><script src="/js/local-search.js"></script><script>var path="/local-search.xml",inputArea=document.querySelector("#local-search-input");inputArea.onclick=function(){searchFunc(path,"local-search-input","local-search-result"),this.onclick=null}</script><script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><script>$("#post img:not(.no-zoom img, img[no-zoom]), img[zoom]").each(function(){var t=document.createElement("a");$(t).attr("data-fancybox","images"),$(t).attr("href",$(this).attr("src")),$(this).wrap(t)})</script><script defer>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?14630c2a053c5952e46094f24dabb623";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></body></html>